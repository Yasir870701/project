import{L as w,aj as x,M as h,a8 as k,Q as S,S as B,T as s,c as a,ak as C,$ as o,al as y,am as c,a2 as p,K as F,_ as M}from"./index-b640046f.js";import{c as N,a as i,u as T,d as m}from"./index.esm-646a7c67.js";import{V as U}from"./VContainer-7afb5e81.js";import{a as d,V as $}from"./VRow-8b5eefeb.js";import{V as q}from"./VForm-11d4b37c.js";import"./_commonjsHelpers-39b5b250.js";/* empty css              */const L=p("h1",null,"登入",-1),P={class:"text-center"},G={__name:"LoginView",setup(R){const n=w(),V=x(),f=h(),b=N({account:i().required("帳號必填").min(4,"帳號最少 4 個字").max(20,"帳號最多 20 個字"),password:i().required("密碼必填").min(4,"密碼最少 4 個字").max(20,"密碼最多 20 個字")}),{handleSubmit:g,isSubmitting:_}=T({validationSchema:b}),t=m("account"),r=m("password"),v=g(async l=>{try{const{data:e}=await k.post("/users/login",{account:l.account,password:l.password});f.login({token:e.result.token,account:e.result.account,email:e.result.email,cart:e.result.cart,role:e.result.role}),n({text:"登入成功",showCloseButton:!1,snackbarProps:{timeout:2e3,color:"green",location:"bottom"}}),V.push("/")}catch(e){n({text:e.response.data.message,showCloseButton:!1,snackbarProps:{timeout:2e3,color:"red",location:"bottom"}})}});return(l,e)=>(S(),B(U,null,{default:s(()=>[a($,null,{default:s(()=>[a(d,{cols:"12"},{default:s(()=>[L]),_:1}),a(C),a(d,{cols:"12"},{default:s(()=>[a(q,{disabled:o(_),onSubmit:y(o(v),["prevent"])},{default:s(()=>[a(c,{modelValue:o(t).value.value,"onUpdate:modelValue":e[0]||(e[0]=u=>o(t).value.value=u),"error-messages":o(t).errorMessage.value,label:"帳號",counter:"",maxlength:"20"},null,8,["modelValue","error-messages"]),a(c,{modelValue:o(r).value.value,"onUpdate:modelValue":e[1]||(e[1]=u=>o(r).value.value=u),"error-messages":o(r).errorMessage.value,label:"密碼",counter:"",maxlength:"20",type:"password"},null,8,["modelValue","error-messages"]),p("div",P,[a(F,{type:"submit",color:"green"},{default:s(()=>[M("登入")]),_:1})])]),_:1},8,["disabled","onSubmit"])]),_:1})]),_:1})]),_:1}))}};export{G as default};
