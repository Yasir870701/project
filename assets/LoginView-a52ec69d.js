import{M as w,al as x,N as h,a9 as k,R as S,T as B,U as s,c as a,am as C,a0 as o,an as y,ao as c,a3 as p,L as F,$ as M}from"./index-1081590e.js";import{c as N,a as i,u as U,d as m}from"./index.esm-c523d3fc.js";import{V as R}from"./VContainer-a4263e19.js";import{a as d,V as T}from"./VRow-7bad0243.js";import{V as $}from"./VForm-f791c321.js";/* empty css              */const q=p("h1",null,"登入",-1),L={class:"text-center"},H={__name:"LoginView",setup(P){const n=w(),V=x(),f=h(),b=N({account:i().required("帳號必填").min(4,"帳號最少 4 個字").max(20,"帳號最多 20 個字"),password:i().required("密碼必填").min(4,"密碼最少 4 個字").max(20,"密碼最多 20 個字")}),{handleSubmit:g,isSubmitting:_}=U({validationSchema:b}),t=m("account"),r=m("password"),v=g(async l=>{try{const{data:e}=await k.post("/users/login",{account:l.account,password:l.password});f.login({token:e.result.token,account:e.result.account,email:e.result.email,cart:e.result.cart,role:e.result.role}),n({text:"登入成功",showCloseButton:!1,snackbarProps:{timeout:2e3,color:"green",location:"bottom"}}),V.push("/")}catch(e){n({text:e.response.data.message,showCloseButton:!1,snackbarProps:{timeout:2e3,color:"red",location:"bottom"}})}});return(l,e)=>(S(),B(R,null,{default:s(()=>[a(T,null,{default:s(()=>[a(d,{cols:"12"},{default:s(()=>[q]),_:1}),a(C),a(d,{cols:"12"},{default:s(()=>[a($,{disabled:o(_),onSubmit:y(o(v),["prevent"])},{default:s(()=>[a(c,{modelValue:o(t).value.value,"onUpdate:modelValue":e[0]||(e[0]=u=>o(t).value.value=u),"error-messages":o(t).errorMessage.value,label:"帳號",counter:"",maxlength:"20"},null,8,["modelValue","error-messages"]),a(c,{modelValue:o(r).value.value,"onUpdate:modelValue":e[1]||(e[1]=u=>o(r).value.value=u),"error-messages":o(r).errorMessage.value,label:"密碼",counter:"",maxlength:"20",type:"password"},null,8,["modelValue","error-messages"]),p("div",L,[a(F,{type:"submit",color:"green"},{default:s(()=>[M("登入")]),_:1})])]),_:1},8,["disabled","onSubmit"])]),_:1})]),_:1})]),_:1}))}};export{H as default};
