import{M as y,N as v,al as V,y as g,q as i,a4 as p,R as c,T as k,U as l,c as o,ay as x,a3 as e,S as u,az as C,X as b,W as w,aA as B,V as S,ax as q,L as N}from"./index-b9b068b1.js";import{V as R}from"./VContainer-40f465e3.js";import{a as _,V as z}from"./VRow-228d7f05.js";/* empty css              */const A=e("h1",null,"收藏",-1),I=e("thead",null,[e("tr",null,[e("th",null,"圖片"),e("th",null,"名稱"),e("th",null,"操作")])],-1),L={key:0},P=e("td",{colspan:"6",class:"text-center"},"沒有收藏",-1),T=[P],M={__name:"CartView",setup(U){const d=y(),h=v();V();const a=g([]),m=async(t,r)=>{try{const{data:s}=await p.post("/users/cart",{product:t,quantity:r}),n=a.value.findIndex(f=>f.product._id===t);a.value[n].quantity+=r,a.value[n].quantity<=0&&a.value.splice(n,1),h.cart=s.result}catch(s){d({text:s.response.data.message,showCloseButton:!1,snackbarProps:{timeout:2e3,color:"red",location:"bottom"}})}};return i(()=>a.value.reduce((t,r)=>t+r.quantity*r.product.price,0)),i(()=>a.value.length>0&&!a.value.some(t=>!t.product.sell)),(async()=>{try{const{data:t}=await p.get("/users/cart");a.value.push(...t.result)}catch(t){d({text:t.response.data.message,showCloseButton:!1,snackbarProps:{timeout:2e3,color:"red",location:"bottom"}})}})(),(t,r)=>(c(),k(R,{class:""},{default:l(()=>[o(z,null,{default:l(()=>[o(_,{cols:"12",class:"text-center"},{default:l(()=>[A]),_:1}),o(_,{class:"justify-center align-center",cols:"12"},{default:l(()=>[o(x,null,{default:l(()=>[I,e("tbody",null,[(c(!0),u(b,null,C(a.value,s=>(c(),u("tr",{key:s._id,class:B({"bg-red-lighten-5":!s.product.sell})},[e("td",null,[o(S,{src:s.product.image,cover:"",width:"200","aspect-ratio":"1"},null,8,["src"])]),e("td",null,q(s.product.name),1),e("td",null,[o(N,{color:"red",variant:"text",icon:"mdi-delete",onClick:n=>m(s.product._id,s.quantity*-1)},null,8,["onClick"])])],2))),128)),a.value.length===0?(c(),u("tr",L,T)):w("",!0)])]),_:1})]),_:1})]),_:1})]),_:1}))}};export{M as default};
